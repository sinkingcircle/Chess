{
  "metadata": {
    "name": "VCHESS",
    "language_info": {
      "name": "JavaScipt",
      "version": "8.0"
    }
  },
  "jsnbversion": "v0.1",
  "cells": [
    {
      "code": "<html lang=\"en\">\n  <head>\n    <meta charset=\"UTF-8\">\n    <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\n    <title>Chessboard with Rules</title>\n    <link rel=\"stylesheet\" href=\"https://unpkg.com/@chrisoakman/chessboardjs@1.0.0/dist/chessboard-1.0.0.min.css\" />\n    <script src=\"https://unpkg.com/@chrisoakman/chessboardjs@1.0.0/dist/chessboard-1.0.0.min.js\"></script>\n    <script src=\"https://cdnjs.cloudflare.com/ajax/libs/chess.js/0.12.0/chess.min.js\"></script>\n  </head>\n    \n  <body>\n\t<center><p id=\"status\"></p> <!-- Display the game status here -->\n\t<p id=\"message\"></p></center>\n    <div style=\"display: flex; align-items: center; justify-content: center; margin-top: 10px;\">\n        <!-- Buttons container aligned side by side -->\n        <div style=\"margin-right: 20px;\">\n            <button id=\"startBtn\" style=\"margin-right: 10px;\">Start Position</button>\n            <button id=\"clearBtn\">Clear Board</button>\n\t\t\t<button id=\"startVoiceControl\">Start Voice Control</button>\n\t\t\t<p>Say commands like \"move f2 f3 || move knight g1 f3 || f2 f3\"</p>\n\t\t\t<p> P.S you can also play manually </p>\n\t\t\t<div id=\"moveHistory\" style=\"margin-top: 20px; font-size: 18px;\">\n  <strong> Recent Moves:</strong>\n  <div id=\"movesList\"></div> <!-- Moves will be displayed here -->\n</div>\n        </div>\n        \n        <!-- Chessboard -->\n        <div id=\"board2\" style=\"width: 500px\"></div>\n    </div>\n\n</body>\n\n</html>",
      "status": "",
      "output": "\n  \n    <meta charset=\"UTF-8\">\n    <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\n    <title>Chessboard with Rules</title>\n    <link rel=\"stylesheet\" href=\"https://unpkg.com/@chrisoakman/chessboardjs@1.0.0/dist/chessboard-1.0.0.min.css\">\n    <script src=\"https://unpkg.com/@chrisoakman/chessboardjs@1.0.0/dist/chessboard-1.0.0.min.js\"></script>\n    <script src=\"https://cdnjs.cloudflare.com/ajax/libs/chess.js/0.12.0/chess.min.js\"></script>\n  \n    \n  \n\t<center><p id=\"status\">White to move</p> <!-- Display the game status here -->\n\t<p id=\"message\"></p></center>\n    <div style=\"display: flex; align-items: center; justify-content: center; margin-top: 10px;\">\n        <!-- Buttons container aligned side by side -->\n        <div style=\"margin-right: 20px;\">\n            <button id=\"startBtn\" style=\"margin-right: 10px;\">Start Position</button>\n            <button id=\"clearBtn\">Clear Board</button>\n\t\t\t<button id=\"startVoiceControl\">Start Voice Control</button>\n\t\t\t<p>Say commands like \"move f2 f3 || move knight g1 f3 || f2 f3\"</p>\n\t\t\t<p> P.S you can also play manually </p>\n\t\t\t<div id=\"moveHistory\" style=\"margin-top: 20px; font-size: 18px;\">\n  <strong> Recent Moves:</strong>\n  <div id=\"movesList\"></div> <!-- Moves will be displayed here -->\n</div>\n        </div>\n        \n        <!-- Chessboard -->\n        <div id=\"board2\" style=\"width: 500px\"><div class=\"chessboard-63f37\"><div class=\"board-b72b1\" style=\"width: 496px;\"><div class=\"row-5277c\"><div class=\"square-55d63 white-1e1d7 square-a8\" style=\"width:62px;height:62px;\" id=\"a8-2a96-97c6-0c68-ccab-257a-27dd-32ec-4ec7\" data-square=\"a8\"><div class=\"notation-322f9 numeric-fc462\">8</div></div><div class=\"square-55d63 black-3c85d square-b8\" style=\"width:62px;height:62px;\" id=\"b8-0f18-d65b-9cca-da88-b1f2-2c45-21ce-e70a\" data-square=\"b8\"></div><div class=\"square-55d63 white-1e1d7 square-c8\" style=\"width:62px;height:62px;\" id=\"c8-6350-b7ac-9c0d-934e-a7e2-7413-88bf-a700\" data-square=\"c8\"></div><div class=\"square-55d63 black-3c85d square-d8\" style=\"width:62px;height:62px;\" id=\"d8-0be7-1c5f-9d5d-c812-ee3b-ade7-cf80-9bdd\" data-square=\"d8\"></div><div class=\"square-55d63 white-1e1d7 square-e8\" style=\"width:62px;height:62px;\" id=\"e8-1391-981c-9ae0-edd6-fded-66b2-9a59-b0ad\" data-square=\"e8\"></div><div class=\"square-55d63 black-3c85d square-f8\" style=\"width:62px;height:62px;\" id=\"f8-3699-4dba-ee5b-7d8e-c6a6-568c-f956-9d7b\" data-square=\"f8\"></div><div class=\"square-55d63 white-1e1d7 square-g8\" style=\"width:62px;height:62px;\" id=\"g8-b380-6ae0-5a60-6a0d-7829-a330-92c9-c582\" data-square=\"g8\"></div><div class=\"square-55d63 black-3c85d square-h8\" style=\"width:62px;height:62px;\" id=\"h8-6c3d-f378-f743-8743-2b10-53c4-77ef-5f48\" data-square=\"h8\"></div><div class=\"clearfix-7da63\"></div></div><div class=\"row-5277c\"><div class=\"square-55d63 black-3c85d square-a7\" style=\"width:62px;height:62px;\" id=\"a7-9ba2-c435-9cf6-a3bd-6822-f78a-c244-8493\" data-square=\"a7\"><div class=\"notation-322f9 numeric-fc462\">7</div></div><div class=\"square-55d63 white-1e1d7 square-b7\" style=\"width:62px;height:62px;\" id=\"b7-dc98-e433-359a-3d5b-1f69-601c-a261-9ed5\" data-square=\"b7\"></div><div class=\"square-55d63 black-3c85d square-c7\" style=\"width:62px;height:62px;\" id=\"c7-23b5-d533-0b79-f44d-6667-2c7d-cb20-d6a0\" data-square=\"c7\"></div><div class=\"square-55d63 white-1e1d7 square-d7\" style=\"width:62px;height:62px;\" id=\"d7-7dd7-510e-4dbc-eef9-51c0-3c74-bdba-50de\" data-square=\"d7\"></div><div class=\"square-55d63 black-3c85d square-e7\" style=\"width:62px;height:62px;\" id=\"e7-859c-b728-808b-099f-a7df-32ca-ce15-9dd5\" data-square=\"e7\"></div><div class=\"square-55d63 white-1e1d7 square-f7\" style=\"width:62px;height:62px;\" id=\"f7-e2e3-3f1f-7488-46cd-64d5-bd40-1bfe-cd63\" data-square=\"f7\"></div><div class=\"square-55d63 black-3c85d square-g7\" style=\"width:62px;height:62px;\" id=\"g7-06b0-a1b1-f4ba-1fbc-ba80-5599-b5b4-c0bc\" data-square=\"g7\"></div><div class=\"square-55d63 white-1e1d7 square-h7\" style=\"width:62px;height:62px;\" id=\"h7-3f41-0ceb-0713-c382-361c-dc54-c16a-e28a\" data-square=\"h7\"></div><div class=\"clearfix-7da63\"></div></div><div class=\"row-5277c\"><div class=\"square-55d63 white-1e1d7 square-a6\" style=\"width:62px;height:62px;\" id=\"a6-3156-4937-146d-589e-edd8-ba14-e2ef-7ea9\" data-square=\"a6\"><div class=\"notation-322f9 numeric-fc462\">6</div></div><div class=\"square-55d63 black-3c85d square-b6\" style=\"width:62px;height:62px;\" id=\"b6-698c-9b8e-b89b-3496-fb02-72c8-c824-acff\" data-square=\"b6\"></div><div class=\"square-55d63 white-1e1d7 square-c6\" style=\"width:62px;height:62px;\" id=\"c6-3ac6-00f8-fb9d-2cb6-215f-b7fd-dfd5-9e09\" data-square=\"c6\"></div><div class=\"square-55d63 black-3c85d square-d6\" style=\"width:62px;height:62px;\" id=\"d6-8f50-7dfe-0033-6adb-b491-a8d8-1e01-2c6d\" data-square=\"d6\"></div><div class=\"square-55d63 white-1e1d7 square-e6\" style=\"width:62px;height:62px;\" id=\"e6-403e-29f3-80ba-a855-3c18-c6bb-14b8-3d54\" data-square=\"e6\"></div><div class=\"square-55d63 black-3c85d square-f6\" style=\"width:62px;height:62px;\" id=\"f6-6a34-edbe-c09f-c2bc-b758-cc61-9a40-f1cc\" data-square=\"f6\"></div><div class=\"square-55d63 white-1e1d7 square-g6\" style=\"width:62px;height:62px;\" id=\"g6-3a08-1673-cfb7-5156-12b1-b1f3-9a22-b0f6\" data-square=\"g6\"></div><div class=\"square-55d63 black-3c85d square-h6\" style=\"width:62px;height:62px;\" id=\"h6-716e-11ff-d411-acf4-2337-85e7-ec2e-a65c\" data-square=\"h6\"></div><div class=\"clearfix-7da63\"></div></div><div class=\"row-5277c\"><div class=\"square-55d63 black-3c85d square-a5\" style=\"width:62px;height:62px;\" id=\"a5-a609-9e12-80c3-a2ae-91e3-6458-df1b-125f\" data-square=\"a5\"><div class=\"notation-322f9 numeric-fc462\">5</div></div><div class=\"square-55d63 white-1e1d7 square-b5\" style=\"width:62px;height:62px;\" id=\"b5-72c2-4bf2-0dd7-dff7-e35d-0c56-4eaa-e0e8\" data-square=\"b5\"></div><div class=\"square-55d63 black-3c85d square-c5\" style=\"width:62px;height:62px;\" id=\"c5-118b-2dc6-83c4-5b43-b57e-82d1-7da8-b77a\" data-square=\"c5\"></div><div class=\"square-55d63 white-1e1d7 square-d5\" style=\"width:62px;height:62px;\" id=\"d5-c099-432e-f54e-252d-ffd5-0eef-8c01-741b\" data-square=\"d5\"></div><div class=\"square-55d63 black-3c85d square-e5\" style=\"width:62px;height:62px;\" id=\"e5-b870-a2e6-36cf-99a8-eeb5-bd87-6b99-915f\" data-square=\"e5\"></div><div class=\"square-55d63 white-1e1d7 square-f5\" style=\"width:62px;height:62px;\" id=\"f5-ae64-d4d4-4cb1-db07-d5cf-2927-2bd8-e721\" data-square=\"f5\"></div><div class=\"square-55d63 black-3c85d square-g5\" style=\"width:62px;height:62px;\" id=\"g5-62a8-bd37-0f21-841e-82b2-61c2-b02d-77e9\" data-square=\"g5\"></div><div class=\"square-55d63 white-1e1d7 square-h5\" style=\"width:62px;height:62px;\" id=\"h5-7d54-dde0-2577-8998-b70f-71cf-a81d-4f1a\" data-square=\"h5\"></div><div class=\"clearfix-7da63\"></div></div><div class=\"row-5277c\"><div class=\"square-55d63 white-1e1d7 square-a4\" style=\"width:62px;height:62px;\" id=\"a4-e082-6ba7-f152-01b6-7285-ef41-b6df-87d4\" data-square=\"a4\"><div class=\"notation-322f9 numeric-fc462\">4</div></div><div class=\"square-55d63 black-3c85d square-b4\" style=\"width:62px;height:62px;\" id=\"b4-b810-43cd-f14c-4244-62e0-32f6-58ea-f030\" data-square=\"b4\"></div><div class=\"square-55d63 white-1e1d7 square-c4\" style=\"width:62px;height:62px;\" id=\"c4-7e11-df9c-db8e-10ae-d7e1-fcb1-9f1f-cdaf\" data-square=\"c4\"></div><div class=\"square-55d63 black-3c85d square-d4\" style=\"width:62px;height:62px;\" id=\"d4-e7ba-74f9-32f4-a2dc-f855-dbe4-1acd-4639\" data-square=\"d4\"></div><div class=\"square-55d63 white-1e1d7 square-e4\" style=\"width:62px;height:62px;\" id=\"e4-967f-4d27-bb27-6adc-3741-d4c9-5d75-0372\" data-square=\"e4\"></div><div class=\"square-55d63 black-3c85d square-f4\" style=\"width:62px;height:62px;\" id=\"f4-6e3a-3b08-f5bd-ac94-1900-3765-05fb-26d8\" data-square=\"f4\"></div><div class=\"square-55d63 white-1e1d7 square-g4\" style=\"width:62px;height:62px;\" id=\"g4-de58-80fe-8e34-596e-5562-a3a2-ac04-0823\" data-square=\"g4\"></div><div class=\"square-55d63 black-3c85d square-h4\" style=\"width:62px;height:62px;\" id=\"h4-8dcf-ed87-c9a0-e52f-f46c-5fd4-fad4-b28e\" data-square=\"h4\"></div><div class=\"clearfix-7da63\"></div></div><div class=\"row-5277c\"><div class=\"square-55d63 black-3c85d square-a3\" style=\"width:62px;height:62px;\" id=\"a3-2f11-383c-72ad-d65a-e0a1-685c-5b82-2b46\" data-square=\"a3\"><div class=\"notation-322f9 numeric-fc462\">3</div></div><div class=\"square-55d63 white-1e1d7 square-b3\" style=\"width:62px;height:62px;\" id=\"b3-ccac-e923-a7bf-0c9f-1bfd-b057-5249-ee86\" data-square=\"b3\"></div><div class=\"square-55d63 black-3c85d square-c3\" style=\"width:62px;height:62px;\" id=\"c3-eeb9-7b07-0485-3867-d224-6822-02df-3a32\" data-square=\"c3\"></div><div class=\"square-55d63 white-1e1d7 square-d3\" style=\"width:62px;height:62px;\" id=\"d3-622c-4415-f477-5c55-d474-3d2f-cc01-4e4d\" data-square=\"d3\"></div><div class=\"square-55d63 black-3c85d square-e3\" style=\"width:62px;height:62px;\" id=\"e3-83bb-eb52-27dd-1f99-0bb4-af4f-c128-3e8f\" data-square=\"e3\"></div><div class=\"square-55d63 white-1e1d7 square-f3\" style=\"width:62px;height:62px;\" id=\"f3-13fb-ab1f-65ca-f67e-a12d-2edc-59bc-15d1\" data-square=\"f3\"></div><div class=\"square-55d63 black-3c85d square-g3\" style=\"width:62px;height:62px;\" id=\"g3-e2dd-b62f-8541-2584-8174-8b45-af79-9f60\" data-square=\"g3\"></div><div class=\"square-55d63 white-1e1d7 square-h3\" style=\"width:62px;height:62px;\" id=\"h3-32fe-622c-3194-e41d-c042-e1a1-b0a9-7dba\" data-square=\"h3\"></div><div class=\"clearfix-7da63\"></div></div><div class=\"row-5277c\"><div class=\"square-55d63 white-1e1d7 square-a2\" style=\"width:62px;height:62px;\" id=\"a2-fcbb-c539-e845-a043-f824-a1f2-1c15-7a09\" data-square=\"a2\"><div class=\"notation-322f9 numeric-fc462\">2</div></div><div class=\"square-55d63 black-3c85d square-b2\" style=\"width:62px;height:62px;\" id=\"b2-e6a4-d799-8bdc-09d6-2964-e14b-f779-1aa5\" data-square=\"b2\"></div><div class=\"square-55d63 white-1e1d7 square-c2\" style=\"width:62px;height:62px;\" id=\"c2-4130-f810-0159-2df1-f0ac-e645-6543-2719\" data-square=\"c2\"></div><div class=\"square-55d63 black-3c85d square-d2\" style=\"width:62px;height:62px;\" id=\"d2-ebd7-33b7-d1d4-0d47-ea20-16a7-39d9-9a09\" data-square=\"d2\"></div><div class=\"square-55d63 white-1e1d7 square-e2\" style=\"width:62px;height:62px;\" id=\"e2-1639-b984-d43c-0ea7-b579-ce7e-4c35-5e1a\" data-square=\"e2\"></div><div class=\"square-55d63 black-3c85d square-f2\" style=\"width:62px;height:62px;\" id=\"f2-488f-1f4b-59ea-0da4-9169-32b5-5a1b-70ec\" data-square=\"f2\"></div><div class=\"square-55d63 white-1e1d7 square-g2\" style=\"width:62px;height:62px;\" id=\"g2-9dcc-3ad9-3a71-d7ec-147a-893c-f38f-c877\" data-square=\"g2\"></div><div class=\"square-55d63 black-3c85d square-h2\" style=\"width:62px;height:62px;\" id=\"h2-20d7-a290-9323-a3bd-04d5-7c30-ac62-9d19\" data-square=\"h2\"></div><div class=\"clearfix-7da63\"></div></div><div class=\"row-5277c\"><div class=\"square-55d63 black-3c85d square-a1\" style=\"width:62px;height:62px;\" id=\"a1-42d6-059f-24e8-19b9-7cc2-9a49-9fc6-48b3\" data-square=\"a1\"><div class=\"notation-322f9 alpha-d2270\">a</div><div class=\"notation-322f9 numeric-fc462\">1</div></div><div class=\"square-55d63 white-1e1d7 square-b1\" style=\"width:62px;height:62px;\" id=\"b1-8640-2e65-c5cb-d701-f847-d1b0-c046-c49b\" data-square=\"b1\"><div class=\"notation-322f9 alpha-d2270\">b</div></div><div class=\"square-55d63 black-3c85d square-c1\" style=\"width:62px;height:62px;\" id=\"c1-a8bc-6c00-1d65-4aad-802e-710d-ce43-842b\" data-square=\"c1\"><div class=\"notation-322f9 alpha-d2270\">c</div></div><div class=\"square-55d63 white-1e1d7 square-d1\" style=\"width:62px;height:62px;\" id=\"d1-4741-32ff-ba10-16c5-19be-fd8a-3b1e-4d97\" data-square=\"d1\"><div class=\"notation-322f9 alpha-d2270\">d</div></div><div class=\"square-55d63 black-3c85d square-e1\" style=\"width:62px;height:62px;\" id=\"e1-ce49-0ec8-54df-3a28-e39d-9af0-2eeb-95b2\" data-square=\"e1\"><div class=\"notation-322f9 alpha-d2270\">e</div></div><div class=\"square-55d63 white-1e1d7 square-f1\" style=\"width:62px;height:62px;\" id=\"f1-70c3-21f9-ce18-19f6-76a9-c9b1-1394-31ab\" data-square=\"f1\"><div class=\"notation-322f9 alpha-d2270\">f</div></div><div class=\"square-55d63 black-3c85d square-g1\" style=\"width:62px;height:62px;\" id=\"g1-524e-650f-b216-5769-7766-2266-b01e-a3c2\" data-square=\"g1\"><div class=\"notation-322f9 alpha-d2270\">g</div></div><div class=\"square-55d63 white-1e1d7 square-h1\" style=\"width:62px;height:62px;\" id=\"h1-ad0e-1716-ee4f-9e8d-3b37-674b-721f-ce5f\" data-square=\"h1\"><div class=\"notation-322f9 alpha-d2270\">h</div></div><div class=\"clearfix-7da63\"></div></div></div></div></div>\n    </div>\n\n\n\n",
      "type": "html"
    },
    {
      "code": "<style>\n  #status {\n            font-size: 24px;\n            font-weight: bold;\n            margin-top: 20px;\n            text-align: center;\n        }\n\n        /* Default color for the status message */\n        #status.default {\n            color: #333;\n        }\n\n        /* White's turn */\n        #status.white-turn {\n            color: white;\n            background-color: #333;\n            padding: 10px;\n        }\n\n        /* Black's turn */\n        #status.black-turn {\n            color: black;\n            background-color: #ddd;\n            padding: 10px;\n        }\n\n        /* Game over with checkmate */\n        #status.checkmate {\n            color: white;\n            background-color: red;\n            padding: 15px;\n            font-size: 28px;\n        }\n\n        /* Game over with draw/stalemate */\n        #status.draw {\n            color: black;\n            background-color: yellow;\n            padding: 15px;\n            font-size: 28px;\n        }\n</style>",
      "status": "",
      "output": "<style>\n  #status {\n            font-size: 24px;\n            font-weight: bold;\n            margin-top: 20px;\n            text-align: center;\n        }\n\n        /* Default color for the status message */\n        #status.default {\n            color: #333;\n        }\n\n        /* White's turn */\n        #status.white-turn {\n            color: white;\n            background-color: #333;\n            padding: 10px;\n        }\n\n        /* Black's turn */\n        #status.black-turn {\n            color: black;\n            background-color: #ddd;\n            padding: 10px;\n        }\n\n        /* Game over with checkmate */\n        #status.checkmate {\n            color: white;\n            background-color: red;\n            padding: 15px;\n            font-size: 28px;\n        }\n\n        /* Game over with draw/stalemate */\n        #status.draw {\n            color: black;\n            background-color: yellow;\n            padding: 15px;\n            font-size: 28px;\n        }\n</style>",
      "type": "html"
    },
    {
      "code": "await scrib.loadScript(\"https://code.jquery.com/jquery-3.5.1.min.js\");\nawait scrib.loadScript(\"https://unpkg.com/@chrisoakman/chessboardjs@1.0.0/dist/chessboard-1.0.0.min.js\");\nawait scrib.loadScript(\"https://cdnjs.cloudflare.com/ajax/libs/chess.js/0.10.3/chess.min.js\")\nawait scrib.loadCSS(\"https://unpkg.com/@chrisoakman/chessboardjs@1.0.0/dist/chessboard-1.0.0.min.css\");",
      "status": "[102]<br><span style=\"font-size:8px\">2ms<span></span></span>",
      "output": "",
      "type": "code"
    },
    {
      "code": "<!-- Add Firebase SDK (for Realtime Database) -->\n\n//FIREBASE  HAS BEEN CONNEFCTED TO DB AND DATA IS STORED THERE FOR ROOM NO AND PLAYER 1 STATUS BUT PLAYER 2 HAS NOT BEEN BUILT\n\n\nconst firebaseAppModule = await import(\"https://www.gstatic.com/firebasejs/10.12.2/firebase-app.js\");\nconst firebaseAuthModule = await import(\"https://www.gstatic.com/firebasejs/10.12.2/firebase-auth.js\");\nconst firebaseRealtimeDBModule = await import(\"https://www.gstatic.com/firebasejs/10.12.2/firebase-database.js\");\nconst { initializeApp } = firebaseAppModule;\nconst { getAuth } = firebaseAuthModule;\nconst { getDatabase, ref, set, get, child, onValue } = firebaseRealtimeDBModule;\n\n// Firebase configuration\nconst firebaseConfig = {\n  apiKey: \"AIzaSyAJrRZ6xehvVQk0PuCMhsVNfeNsJzXVmCY\",\n  authDomain: \"vchess-82304.firebaseapp.com\",\n  databaseURL: \"https://vchess-82304-default-rtdb.asia-southeast1.firebasedatabase.app\",\n  projectId: \"vchess-82304\",\n  storageBucket: \"vchess-82304.firebasestorage.app\",\n  messagingSenderId: \"630416421002\",\n  appId: \"1:630416421002:web:604dabeccb74ac778f7d73\",\n  measurementId: \"G-YF3S8Y3FPK\"\n};\n\nconst app = initializeApp(firebaseConfig);\nconst db = getDatabase(app);\n\nconst game = new Chess();  // Initialize Chess.js\n\nlet isOnline = navigator.onLine;\nif (isOnline) {\n  updateStatus(\"You are online. Waiting for Player 2...\");\n  createGameRoom();\n} else {\n  updateStatus(\"You are offline. Playing solo...\");\n  showOfflineGame();\n}\n\nfunction updateStatus(message) {\n  document.getElementById(\"status\").innerText = message;\n}\n\nfunction showOfflineGame() {\n  console.log(\"Offline mode: Solo play\");\n}\n\nfunction createGameRoom() {\n  const gameId = generateGameId();  // Generate a unique game ID\n  const gameRef = ref(db, \"games/\" + gameId);\n\n  // Set the game state in Firebase\n  set(gameRef, {\n    player1: {\n      name: \"Player 1\",\n      color: \"w\"\n    },\n    gameState: {\n      board: game.fen(),\n      turn: \"w\"\n    },\n    moves: []  // Empty moves array for now\n  }).then(() => {\n    console.log(\"Game room created with ID:\", gameId);\n    updateGameRoomInfo(gameId);\n    watchForOpponent(gameId);\n  }).catch(error => {\n    console.error(\"Error creating game room:\", error);\n  });\n}\n\nfunction updateGameRoomInfo(gameId) {\n  document.getElementById(\"game-room-info\").innerText = \"Game Room ID: \" + gameId;\n}\n\nfunction watchForOpponent(gameId) {\n  const gameRef = ref(db, \"games/\" + gameId);\n\n  onValue(gameRef, (snapshot) => {\n    const gameData = snapshot.val();\n    if (gameData && !gameData.player2) {\n      updateStatus(\"Waiting for Player 2...\");\n      document.getElementById(\"player2-name\").innerText = \"Waiting for Player 2...\";\n    } else {\n      updateStatus(\"Player 2 has joined. Starting the game!\");\n      document.getElementById(\"player2-name\").innerText = gameData.player2 ? gameData.player2.name : \"Player 2\";\n      startGame(gameId);\n    }\n  });\n}\n\nfunction startGame(gameId) {\n  const board = Chessboard('#board-container', {\n    draggable: true,\n    dropOffBoard: 'trash',\n    sparePieces: true\n  });\n\n  board.start();\n\n  // Listen to move changes and update Firebase\n  board.on('drop', (source, target) => {\n    onMoveMade(gameId, source, target);\n  });\n}\n\nfunction onMoveMade(gameId, source, target) {\n  const gameRef = ref(db, \"games/\" + gameId);\n  const gameState = new Chess(game.fen());  // Use the current FEN for move\n\n  const move = gameState.move({ from: source, to: target, promotion: 'q' });\n\n  if (move === null) return \"snapback\";\n\n  // Push move to Firebase\n  const movesRef = child(gameRef, \"moves\");\n  const newMoveRef = push(movesRef);\n  set(newMoveRef, move.san);\n\n  // Update the game state in Firebase\n  set(gameRef, {\n    player1: gameData.player1,\n    player2: gameData.player2,\n    gameState: {\n      board: gameState.fen(),\n      turn: gameState.turn()\n    },\n    moves: gameData.moves\n  });\n\n  // Update the chessboard and the move history in the UI\n  board.position(gameState.fen());\n  updateMoveHistory(move.san);\n}\n\nfunction updateMoveHistory(move) {\n  const moveHistoryElement = document.getElementById('movesList');\n  const moveItem = document.createElement('li');\n  moveItem.textContent = move;\n  moveHistoryElement.appendChild(moveItem);\n}\n\nfunction generateGameId() {\n  return \"game_\" + new Date().getTime();\n}\n\ndocument.getElementById(\"join-game\").addEventListener(\"click\", function() {\n  const gameId = document.getElementById(\"game-id\").value;\n  if (gameId) {\n    joinGame(gameId);\n  } else {\n    alert(\"Please enter a valid game ID.\");\n  }\n});\n",
      "status": "[-]",
      "output": "<p class=\"error\">Cannot read properties of null (reading 'addEventListener')</p>",
      "type": "code"
    },
    {
      "code": "<!-- Add Firebase SDK (for Realtime Database) -->\n\n//firebase has been added and connected it creates a room along with player 1 assigned to white 2 player is yet to be done\nconst firebaseAppModule = await import(\"https://www.gstatic.com/firebasejs/10.12.2/firebase-app.js\");\nconst firebaseAuthModule = await import(\"https://www.gstatic.com/firebasejs/10.12.2/firebase-auth.js\");\nconst firebaseRealtimeDBModule = await import(\"https://www.gstatic.com/firebasejs/10.12.2/firebase-database.js\");\nconst { initializeApp } = firebaseAppModule;\nconst { getAuth } = firebaseAuthModule;\nconst { getDatabase, ref, set, get, child, onValue } = firebaseRealtimeDBModule;\n\n// Firebase configuration\nconst firebaseConfig = {\n  apiKey: \"AIzaSyAJrRZ6xehvVQk0PuCMhsVNfeNsJzXVmCY\",\n  authDomain: \"vchess-82304.firebaseapp.com\",\n  databaseURL: \"https://vchess-82304-default-rtdb.asia-southeast1.firebasedatabase.app\",\n  projectId: \"vchess-82304\",\n  storageBucket: \"vchess-82304.firebasestorage.app\",\n  messagingSenderId: \"630416421002\",\n  appId: \"1:630416421002:web:604dabeccb74ac778f7d73\",\n  measurementId: \"G-YF3S8Y3FPK\"\n};\n\nconst app = initializeApp(firebaseConfig);\nconst db = getDatabase(app);\n\nconst game = new Chess();  // Initialize Chess.js\n\nlet isOnline = navigator.onLine;\nif (isOnline) {\n  updateStatus(\"You are online. Waiting for Player 2...\");\n  createGameRoom();\n} else {\n  updateStatus(\"You are offline. Playing solo...\");\n  showOfflineGame();\n}\n\nfunction updateStatus(message) {\n  document.getElementById(\"status\").innerText = message;\n}\n\nfunction showOfflineGame() {\n  console.log(\"Offline mode: Solo play\");\n}\n\nfunction createGameRoom() {\n  const gameId = generateGameId();  // Generate a unique game ID\n  const gameRef = ref(db, \"games/\" + gameId);\n\n  // Set the game state in Firebase\n  set(gameRef, {\n    player1: {\n      name: \"Player 1\",\n      color: \"w\"\n    },\n    gameState: {\n      board: game.fen(),\n      turn: \"w\"\n    },\n    moves: []  // Empty moves array for now\n  }).then(() => {\n    console.log(\"Game room created with ID:\", gameId);\n    updateGameRoomInfo(gameId);\n    watchForOpponent(gameId);\n  }).catch(error => {\n    console.error(\"Error creating game room:\", error);\n  });\n}\n\nfunction updateGameRoomInfo(gameId) {\n  document.getElementById(\"game-room-info\").innerText = \"Game Room ID: \" + gameId;\n}\n\nfunction watchForOpponent(gameId) {\n  const gameRef = ref(db, \"games/\" + gameId);\n\n  onValue(gameRef, (snapshot) => {\n    const gameData = snapshot.val();\n    if (gameData && !gameData.player2) {\n      updateStatus(\"Waiting for Player 2...\");\n      document.getElementById(\"player2-name\").innerText = \"Waiting for Player 2...\";\n    } else {\n      updateStatus(\"Player 2 has joined. Starting the game!\");\n      document.getElementById(\"player2-name\").innerText = gameData.player2 ? gameData.player2.name : \"Player 2\";\n      startGame(gameId);\n    }\n  });\n}\n\nfunction startGame(gameId) {\n  const board = Chessboard('#board-container', {\n    draggable: true,\n    dropOffBoard: 'trash',\n    sparePieces: true\n  });\n\n  board.start();\n\n  // Listen to move changes and update Firebase\n  board.on('drop', (source, target) => {\n    onMoveMade(gameId, source, target);\n  });\n}\n\nfunction onMoveMade(gameId, source, target) {\n  const gameRef = ref(db, \"games/\" + gameId);\n  const gameState = new Chess(game.fen());  // Use the current FEN for move\n\n  const move = gameState.move({ from: source, to: target, promotion: 'q' });\n\n  if (move === null) return \"snapback\";\n\n  // Push move to Firebase\n  const movesRef = child(gameRef, \"moves\");\n  const newMoveRef = push(movesRef);\n  set(newMoveRef, move.san);\n\n  // Update the game state in Firebase\n  set(gameRef, {\n    player1: gameData.player1,\n    player2: gameData.player2,\n    gameState: {\n      board: gameState.fen(),\n      turn: gameState.turn()\n    },\n    moves: gameData.moves\n  });\n\n  // Update the chessboard and the move history in the UI\n  board.position(gameState.fen());\n  updateMoveHistory(move.san);\n}\n\nfunction updateMoveHistory(move) {\n  const moveHistoryElement = document.getElementById('movesList');\n  const moveItem = document.createElement('li');\n  moveItem.textContent = move;\n  moveHistoryElement.appendChild(moveItem);\n}\n\nfunction generateGameId() {\n  return \"game_\" + new Date().getTime();\n}\n\ndocument.getElementById(\"join-game\").addEventListener(\"click\", function() {\n  const gameId = document.getElementById(\"game-id\").value;\n  if (gameId) {\n    joinGame(gameId);\n  } else {\n    alert(\"Please enter a valid game ID.\");\n  }\n});\n",
      "status": "[-]",
      "output": "<p class=\"error\">Cannot read properties of null (reading 'addEventListener')</p>",
      "type": "code"
    },
    {
      "code": "// Initialize SpeechRecognition and set properties\nvar SpeechRecognition = window.SpeechRecognition || window.webkitSpeechRecognition;\nvar recognition = new SpeechRecognition();\nrecognition.lang = 'en-US';\nrecognition.interimResults = false;\nrecognition.maxAlternatives = 1;\n\n// Set flags to manage the state\nlet isRecognitionActive = false;\n\n// Handle recognition errors\nrecognition.onerror = function(event) {\n  console.error(\"Speech recognition error:\", event.error);\n  displayMessage(\"Speech recognition error:\", event.error);\n};\n\n// Handle start and end events\nrecognition.onstart = function() {\n  isRecognitionActive = true;\n  console.log(\"Speech recognition started.\");\n  displayMessage(\"Speech recognition started. Please speak your move.\");\n};\n\nrecognition.onend = function() {\n  isRecognitionActive = false;\n  console.log(\"Speech recognition stopped.\");\n};\n\n// Handle speech results\nrecognition.onresult = function(event) {\n  var transcript = event.results[0][0].transcript.toLowerCase();\n  console.log(\"Voice command received:\", transcript);\n  processVoiceCommand(transcript);\n};\n\n// Function to start recognition safely\nfunction startRecognition() {\n  if (isRecognitionActive) {\n    recognition.stop(); // Stop recognition if already active\n  }\n  recognition.start(); // Start recognition\n}\n\nfunction displayMessage(msg) {\n        document.getElementById('message').innerText = msg;\n      }\n\n// Start listening on a button click\ndocument.getElementById('startVoiceControl').addEventListener('click', function() {\n  startRecognition();\n  console.log(\"Voice control started. Please speak your move.\");\n  displayMessage(\"Voice control started. Please speak your move.\");\n});\n\n// Process voice command and handle moves\nfunction processVoiceCommand(command) {\n        // Use regex to capture optional piece and required source and target squares\n        var movePattern = /(?:pawn|knight|bishop|rook|queen|king)?\\s*([a-h][1-8])\\s+([a-h][1-8])/i;\n        var moveMatch = command.match(movePattern);\n\n        if (moveMatch) {\n          var sourceSquare = moveMatch[1];\n          var targetSquare = moveMatch[2];\n\n          // Detect the piece on the source square if none was specified\n          var pieceOnSource = game.get(sourceSquare);\n          if (pieceOnSource) {\n            var piece = pieceOnSource.type; // Get piece type from board\n          } else {\n            displayMessage(`No piece found on ${sourceSquare}. Try a valid source square.`);\n            return;\n          }\n\n          // Attempt to move the piece\n          var move = game.move({\n            from: sourceSquare,\n            to: targetSquare,\n            promotion: 'q' // Auto-promote to queen if needed\n          });\n\n          if (move) {\n            board2.position(game.fen());\n            updateStatus();\n\t\t\tboard2.flip();\n            updateMoveHistory(move.san);\n            displayMessage(`Move executed: ${piece} from ${sourceSquare} to ${targetSquare}`);\n          } else {\n            displayMessage(\"Illegal move. Try again.\");\n          }\n        } else {\n          displayMessage(\"Invalid command format. Please specify moves like 'e2 e3' or 'knight g1 f3'.\");\n        }\n      }\n\n// Find source square for specified piece and target\nfunction findSourceSquare(pieceSymbol, sourceSquare, targetSquare) {\n  var moves = game.moves({ verbose: true });\n  var matchingMoves = moves.filter(function(m) {\n    return (!pieceSymbol || m.piece === pieceSymbol.toLowerCase()) && m.from === sourceSquare && m.to === targetSquare;\n  });\n\n  return matchingMoves.length > 0 ? matchingMoves[0].from : null;\n}\n\n\n// Chessboard and game event functions\nvar board2 = ChessBoard('board2', {\n      draggable: true,\n      pieceTheme: 'https://chessboardjs.com/img/chesspieces/alpha/{piece}.png',\n      dropOffBoard: 'trash',\n      onDragStart: onDragStart,\n      onDrop: onDrop,\n      onSnapEnd: onSnapEnd\n    });\n\n    var game = new Chess();\n    var gameOver = false; // Flag to track if the game is over\n\n    // Function to prevent illegal moves or moves by the wrong player\nfunction onDragStart(source, piece, position, orientation) {\n      if (gameOver) return false; // Disable dragging if the game is over\n      if ((game.turn() === 'w' && piece.startsWith('b')) || \n          (game.turn() === 'b' && piece.startsWith('w'))) {\n        return false;\n      }\n}\n\n    // Function to handle piece drop and validate move\nfunction onDrop(source, target) {\n  if (gameOver) return 'snapback'; // Disable dropping if the game is over\n\n  var move = game.move({\n    from: source,\n    to: target,\n    promotion: 'q'  // Auto-promote to queen for simplicity\n  });\n\n  if (move === null) return 'snapback';  // Illegal move\n  \n  board2.flip(); // Flip the board on every valid move\n  updateStatus();  // Update game status after each valid move\n  updateMoveHistory(move.san);  // Add the move to the move history\n}\n\n    // Sync board position with game state after each move\nfunction onSnapEnd() {\n      board2.position(game.fen());\n}\n\n    // Function to update board and game status\nfunction updateStatus() {\n      var status = '';\n\n      if (game.in_checkmate()) {\n        status = 'Game over, ' + (game.turn() === 'w' ? 'White' : 'Black') + ' is in checkmate.';\n        gameOver = true; // Set game over flag\n      } else if (game.in_draw() || game.in_stalemate() || game.in_threefold_repetition() || game.insufficient_material()) {\n        status = 'Game over, it\\'s a draw!';\n        gameOver = true; // Set game over flag\n      } else {\n        status = (game.turn() === 'w' ? 'White' : 'Black') + ' to move';\n        if (game.in_check()) {\n          status += ', in check!';\n        }\n      }\n\n      document.getElementById('status').innerText = status; // Display status message\n}\n\n// Function to update move history display\nvar moveHistory = []; // To store the move history\nvar moveCount = 0; // Global move count to track the absolute turn\n\nfunction updateMoveHistory(move) {\n  // Add the move to the history\n  moveHistory.push(move);\n  moveCount++; // Increment the move count with each new move\n\n  // Keep only the most recent 8 moves\n  if (moveHistory.length > 8) {\n    moveHistory.shift(); // Remove the oldest move\n  }\n\n  // Update the move list display\n  var movesList = document.getElementById('movesList');\n  movesList.innerHTML = ''; // Clear the current move list\n\n  // Display moves in the correct turn order\n  moveHistory.forEach(function (move, index) {\n    // Calculate the turn based on the moveCount and index\n    var turn = ((moveCount - moveHistory.length + index) % 2 === 0) ? 'w' : 'b';\n\n    // Get the color and piece from the move and format it\n    var moveText = formatMove(move, turn); // Use calculated turn for formatting\n    var moveItem = document.createElement('div');\n    moveItem.textContent = moveText;\n    movesList.appendChild(moveItem);\n  });\n}\n\n\n    // Format the move as \"white-pawn-d6\" or \"black-pawn-d5\"\nfunction formatMove(move, turn) {\n  // Determine the color of the player making the move\n  var color = (turn === 'w') ? 'white' : 'black'; // 'w' for white and 'b' for black\n  \n  // Handle castling moves\n  if (move === \"O-O\") {\n    return color + '-castled-kingside';\n  } else if (move === \"O-O-O\") {\n    return color + '-castled-queenside';\n  }\n\n  // Map the first character to the piece type\n  var piece;\n  var moveIndex = 0;  // To track if the move starts with a piece character\n\n  // Check if the first character is a valid piece (Knight, Rook, King, Queen)\n  if (move.charAt(0) === 'N') {\n    piece = 'knight';\n    moveIndex = 1;  // Skip the first character (since it's part of the piece)\n  } else if (move.charAt(0) === 'R') {\n    piece = 'rook';\n    moveIndex = 1;\n  } else if (move.charAt(0) === 'K') {\n    piece = 'king';\n    moveIndex = 1;\n  } else if (move.charAt(0) === 'Q') {\n    piece = 'queen';\n    moveIndex = 1;\n  } else if (move.charAt(0) === 'B') {\n    piece = 'bishop';\n    moveIndex = 1;\n  } else {\n    piece = 'pawn';  // If no piece character, it's a pawn\n    moveIndex = 0;  // No need to skip any character\n  }\n\n  // Check for checkmate notation (#) and return checkmate message if present\n  if (move.includes('#')) {\n    return color + '-' + piece + '-checkmate';\n  }\n\n  // Remove any capture or check symbols for easier parsing\n  var cleanedMove = move.replace(/[x+]/g, ''); // Remove 'x' (captures) and '+' (checks)\n\n  // Determine the target square (last two characters of the move)\n  var targetSquare = cleanedMove.slice(-2);\n\n  // Handle pawn captures and simple moves\n  if (piece === 'pawn') {\n    if (move.length > 3) {\n      // Pawn capture move (e.g., e5xd6 -> white-pawn-e5-x-d6)\n      var captureSquare = move.slice(2, 4);  // Capture destination (e.g., \"d6\" in e5xd6)\n      return color + '-pawn-' + 'x-' + captureSquare;\n    } else {\n      // Simple pawn move (e.g., e2-e4 -> white-pawn-e4)\n      return color + '-pawn-' + targetSquare;\n    }\n  } else {\n    // Handle non-pawn pieces (e.g., Knight, Rook, etc.)\n    var capture = move.includes('x'); // Check if it's a capture (e.g., Rxd4)\n\n    if (capture) {\n      // Format capture moves (e.g., Rook capture: Rxd5 -> white-rook-d4-x-d5)\n      return color + '-' + piece + '-x-' + targetSquare;\n    } else {\n      // Non-capture piece move (e.g., Knight move: Nf3 -> white-knight-f3)\n      return color + '-' + piece + '-' + targetSquare;\n    }\n  }\n}\n\n\n\n\n\n    // Button controls to reset and clear the board\n    document.getElementById('startBtn').addEventListener('click', function() {\n      game.reset();  // Reset chess game\n\t  board2.orientation('white'); // Set board orientation to White's side\n      board2.start(); // Reset chessboard visualization\n      gameOver = false; // Reset game over flag\n      updateStatus(); // Update the status\n      document.getElementById('movesList').innerHTML = '';  // Clear the move history\n\t  moveHistory = [];\n    });\n\n    document.getElementById('clearBtn').addEventListener('click', function() {\n      game.clear();   // Clear chess game\n      board2.clear(); // Clear chessboard visualization\n      gameOver = false; // Reset game over flag\n      document.getElementById('status').innerText = 'Board cleared.'; // Clear status\n      document.getElementById('movesList').innerHTML = '';  // Clear the move history\n    });\n\n    updateStatus();",
      "status": "[103]<br><span style=\"font-size:8px\">7ms<span></span></span>",
      "output": "",
      "type": "code"
    }
  ],
  "source": "https://github.com/gopi-suvanam/jsnb",
  "run_on_load": false
}